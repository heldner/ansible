---
- name: Install mpv and mplayer
  ansible.builtin.package:
    state: present
    name:
      - mplayer
      - mpv
      - mpv-mpris
      - youtube-dl
  tags: mpv
  become: true

- name: Create mpv config dir
  ansible.builtin.file:
    state: directory
    path: '{{ item }}'
    mode: "0755"
  loop:
    - '{{ ansible_user_dir }}/.config/mpv'
    - '{{ ansible_user_dir }}/.config/mpv/scripts'
    - '{{ ansible_user_dir }}/.config/mpv/scripts/sponsorblock_shared'
  tags: mpv

- name: Copy mpv config
  ansible.builtin.copy:
    src: mpv.conf
    dest: '{{ ansible_user_dir }}/.config/mpv/mpv.conf'
    mode: '0644'
  tags: mpv

- name: Copy mpv scripts
  ansible.builtin.copy:
    src: '{{ item }}'
    dest: '{{ ansible_user_dir }}/.config/mpv/{{ item }}'
    mode: '0644'
  loop:
    - scripts/history.lua
    - scripts/sponsorblock.lua
    - scripts/sponsorblock_shared/sponsorblock.py
    - scripts/sponsorblock_shared/main.lua
    - scripts/sponsorblock_shared/sponsorblock.txt
  tags: mpv

- name: Copy mpv action for dwm
  ansible.builtin.import_role:
    name: dwm
    tasks_from: copy_action
  vars:
    dwm_actions:
      - mpv
  tags: mpv
